<html>
<body>


<style>
	#box, #links, #dbg {
		margin: 2em;
		border: solid 1px black;
		padding: 2em;
	}
	pre, #progress { color: #888; }
	#dbg { color: #800; }
</style>
<div id=box>
	<div id=target> [ DROP FILES HERE TO UPLOAD ] </div>
	<div id=progress>(progress)</div>
</div>
<div id=links>(links)</div>
<div id=dbg>(debug)</div>


<script src="/dadu.js"></script>
<script>

	var target = document.getElementById('target')
	var progress = document.getElementById('progress')
	var links = document.getElementById('links')

	function dbg(s) {
		var e = document.getElementById('dbg')
		e.innerHTML = s+"<br>"+e.innerHTML
	}

	dadu.add('target', function(xfers) {

		var s = ""
		if(xfers.done)
			s = "Done.<br>"
		s += "Finished "+xfers.filesDone+" of "+xfers.filesTotal+" files<br>"
		if(xfers.filesFailed > 0)
			s += xfers.filesFailed+" files failed<br>"
		if(xfers.current)
			s += "Sending "+xfers.current.fileName+"<br>"
		s += "Progress "+xfers.percent+"%<br>"
		progress.innerHTML = s

		dbg("<pre>"+s+"</pre>");

	
		s = ""
		for(var i = 0; i < xfers.ok.length; i++) {
			var f = xfers.ok[i]
			s += "<a href='/"+f.hashName+"'>"+f.fileName+"</a><br>"
		}
		links.innerHTML = s

	}, function() {
		target.style.color = "#0f0";
	}, function() {
		target.style.color = "#000";
	})

</script>


